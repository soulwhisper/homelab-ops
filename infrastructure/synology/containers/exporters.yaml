---
# Optimized for synology

services:
  snmp-exporter:
    image: "quay.io/prometheus/snmp-exporter:latest"
    container_name: "snmp-exporter"
    restart: "unless-stopped"
    command:
      - "--config.file=/etc/snmp_exporter/snmp.yml"
    ports:
      - "9116:9116/tcp"
    volumes:
      # https://grafana.com/grafana/dashboards/14284-synology-nas-details/
      # https://github.com/tumak66/grafana-prometheus-synology/blob/main/snmp-exporter/snmp.yml
      - "/volume3/docker/snmp-exporter/snmp.yml:/etc/snmp_exporter/snmp.yml:ro"

  node-exporter:
    image: "quay.io/prometheus/node-exporter:latest"
    container_name: "node-exporter"
    restart: "unless-stopped"
    command:
      - "--path.rootfs=/host"
      - "--path.udev.data=/host/run/udev/data"
      - "--web.listen-address=0.0.0.0:9100"
      - "--collector.filesystem.mount-points-exclude=^/(dev|proc|sys|var/lib/docker/.+)($$|/)"
      - "--collector.filesystem.fs-types-exclude=^(autofs|binfmt_misc|bpf|cgroup2?|configfs|debugfs|devpts|devtmpfs|fusectl|mqueue|nsfs|overlay|proc|procfs|rpc_pipefs|securityfs|selinuxfs|squashfs|sysfs|tracefs)$"
    network_mode: host
    pid: "host"
    volumes:
      - "/:/host:ro"

  smartctl-exporter:
    image: "quay.io/prometheuscommunity/smartctl-exporter:latest"
    container_name: "smartctl-exporter"
    restart: "unless-stopped"
    command:
      - "--no-smartctl.scan"
      - "--smartctl.device=/dev/nvme0;nvme"
      - "--smartctl.device=/dev/nvme1;nvme"
      - "--smartctl.device=/dev/sata1;sat"
      - "--smartctl.device=/dev/sata2;sat"
    ports:
      - "9633:9633"
    privileged: "true"
    user: "root"
